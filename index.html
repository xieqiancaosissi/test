<html>
  <head>
  </head>
  <style>
    .btn{
      width:250px;
      height:80px;
      font-size:28px;
      display:block;
      margin:30px;
    }
  </style>
  <body>
    <button class="btn" onclick="clickMe()">点击我拉起</button>
    <button class="btn" onclick="openApp()">拉起再下载</button>
    <button class="btn" onclick="downlaod()">点击我下载</button>
  </body>
</html>

<script type="text/javascript">
//   let downloadDelay = 1500;
  const appUrl = 'pptv://page?userfrom=page_home';
//   const openTab = window.open(appUrl);
  function download() {
      window.location.href = '//app.aplus.pptv.com/minisite/pptvaphone/m_app_down/pg_yd1';
    }
//    setTimeout(() => openTab && openTab.close(), 1500);
//   window.setTimeout(() => {
//   const child = document.querySelector('#openappiframe');
//   document.getElementsByTagName('body')[0].removeChild(child);
//   if (document.visibilityState !== 'hidden') {
//       download();
//     }
//   }, downloadDelay);
//   const f = document.createElement('iframe');
//   f.setAttribute('id', 'openappiframe');
//   f.setAttribute('style', 'display:none');
//   f.setAttribute('src', appUrl);
//   document.getElementsByTagName('body')[0].appendChild(f);
  window.onload = function() {
openApp();
}
   function openApp() {
     var before = new Date().getTime();
      window.location.href = appUrl;
      setTimeout(function () {
          var after = new Date().getTime();
          if ((after - before) < 2050) {
            download();
          }
      }, 2000);
   }
</script>
